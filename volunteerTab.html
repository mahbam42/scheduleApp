<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Prototype 5 Volunteer Logic - Schedule App</title>

	<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />
	<link rel="stylesheet" href="style/main.css" />

	<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
	<script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js"></script>
    <script src="scripts/dragAndDrop.js"></script>

	<style type="text/css">
		#tabs {
			height: 20%;
			border: thin solid black;
			font-size: 10px;
		}
		#tabs div {
			padding-left: 2%;
		}
	</style>
	<script>
	// Experimental Stuff goes here!
$(document).ready(function () {
    $("#tabs").tabs();
});

$(document).ready( function() {
	// Set-up a new event schedule 
	$('#btnNewEvent').click( function() {
		// Add Event Name 
		if ($('#txtEventName').val() !== ""){
			$('#eventName').text($('#txtEventName').val());
		}
		// Get Event Lenght
		function parseDate(str) {
			var mdy = str.split('-');
			return new Date(mdy[0], mdy[1] - 1, mdy[2]);
		}
		// Subtracts start date from the end date to get the number of days 
		function daydiff(first, second) {
			return ((second - first)/(1000*60*60*24));
		}
		eventLength = daydiff(parseDate($('#startDate').val()), parseDate($('#endDate').val()));

		// Set up what to add for each day 
		for(var i = 0; i <= eventLength; i++){
			// Set-up for adding the date to each 'day' 
			mdy = $('#startDate').val().split('-');
			var dayN = new Date(mdy[0], mdy[1]-1, mdy[2]+++i)
			var eventDay = (i+1); // Not strictly necessary but useful for the lazy 
			var day = '<div class="day"><h3>' + dayN.toDateString() + ' - Day ' + eventDay + '</h3>';
			// stick it in there! 
			$('#eventContainer').append($(day));
		};

		// Add shift length global variable 
	}); // End btnNewEvent click event

	// Add volunteer panel logic -all 
	$('#btnAddVolunteer').click( function(){
		// Set up the variables 
		// Volunteer Name
		var $name = $('#txtVolunteer').val();
		// Number of Shifts to Add 
		var $shifts = $('#txtShifts').val();
		var $shiftContainer = '<div class="rowContainer"><div class="name"><p>' + $name + '</p></div><div class="row"></div></div>';

		// For Each Container add the name of the volunteer and the shift holder 
		$('.day').each( function() {
			$(this).append($shiftContainer); // pulled ".children('.rowContainer')" from this line to hopefully solve a problem... 
			// Call addNew() on .name here 
		});
		// In each row... 
		$('.rowContainer').each( function() {
			// ... first check to see if div.name = $name then do the rest of the magic...
			if ($name == $(this).children('.name').text()){
				// ...then loop through the number of shifts indicated for the Volunteer and add them to each row 
				for (var i = 0; i < $shifts; i++){
					var shiftHTML = '<div class="shift"><span class="close">X</span><p>Regular Shift</p></div>';
					var $newshift = $(shiftHTML);
					$(this).children(".row").append($newshift);
					stretch($newshift);
					drag($newshift);
					closer($newshift);
				};
			}
				
		});
	}); // End btnAddVolunteer click event 
});


	</script>
</head>
<body>

	<h1>Schedule App</h1>
	<p>RGX Consulting Services &copy; 2013</p>

	<div id="tabs">
		<ol>
			<li><a href="#tab-1">Event Set-up</a></li>
			<li><a href="#tab-2">Volunteers</a></li>
			<li><a href="#tab-3">Info</a></li>
		</ol>
		<div id="tab-1"><!-- Event Set-up -->
			<table>
				<tr>
					<td></td>
					<td>Start Date</td>
					<td>End Date</td>
					<td>Default Shift Length (in Hours)</td>
					<td rowspan="2">
						<input type="button" id="btnNewEvent" value="Create Schedule">
					</td>
				</tr>
				<tr>
					<td><input type="text" name="eventName" id="txtEventName" placeholder="Event Name"></td>
					<td><input type="date" name="startDate" id="startDate"></td>
					<td><input type="date" name="endDate" id="endDate"></td>
					<td><input type="number" name="defaultShiftLength" id="defaultShiftLength"></td>
				</tr>
			</table>
		</div>
		<div id="tab-2"><!-- Volunteer Info -->
			<table>
				<tr>
					<td>Name</td>
					<td># of Shifts</td>
					<td>Length of Shifts (in Hours)</td>
					<td rowspan="2">
						<input type="button" id="btnAddVolunteer" value="Add Volunteer">
					</td>
				</tr>
				<tr>
					<td><input type="text" name="volunteer" id="txtVolunteer"></td>
					<td><input type="number" name="shifts" id="txtShifts"></td>
					<td><input type="number" name="shiftLenght" id="shiftLength"></td>
				</tr>
			</table>
		</div>
		<div id="tab-3"><!-- Application Info -->
			<ul>
				<li>Use the "Event Set-up" Tab to enter the Event name and dates</li>
				<li>Use the "Volunteers" Tab to quickly add a volunteer to the schedule</li>
				<li>
					Using the Schedule Grid:
					<ul>
						<li>Click on a Volunteer's name to add a shift for a given day</li>
						<li>Shifts can be moved by clicking anywhere in a shift and dragging it (Shifts snap to 1/2 hour intervals)</li>
						<li>Shifts can be deleted by clicking on the "X" in the top right corner</li>
					</ul>
				</li>
				<p>This application is developed and maintained by <a href="http://maxbrother.com">Max Brother Technologies</a> to report an issue or request features please <a href="https://github.com/mahbam42/scheduleApp/issues/new">Contact Us</a></p>				
			</ul>
		</div>
	</div><!-- End Control Panel -->
	<div id="eventContainer">
		<!--<h2 id="eventName">taco</h2>

	<div class="day"><h3>Tue Apr 09 2013 - Day 1</h3><div class="rowContainer"></div></div><div class="day"><h3>Wed Apr 10 2013 - Day 2</h3><div class="rowContainer"></div></div><div class="day"><h3>Thu Apr 11 2013 - Day 3</h3><div class="rowContainer"></div></div><div class="day"><h3>Fri Apr 12 2013 - Day 4</h3><div class="rowContainer"></div></div>--></div>
</body>
</html>